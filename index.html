<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>agraj - Portfolio</title>
    <link rel="icon" type="image/png" href="frieren.png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Baloo+Bhai+2:wght@700&family=Inter:wght@400;500;600;700&family=Lato:ital,wght@0,400;0,700;1,400&family=Outfit:wght@400;500;700&family=Nunito:wght@400;700&family=Fuzzy+Bubbles:wght@400;700&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Removed tsParticles -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>

    <script>
        // Tailwind Config (Same as previous)
        window.tailwind.config = { /* ... */ };
        // Paste the full Tailwind config from the previous successful response
        window.tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dark': '#0f0a19', 'darker': '#090613', 'accent': '#9272CE',
                        'accent-hover': '#AE8BD5', 'light-accent': '#CBB8E8',
                        'text-primary': '#ffffff', 'text-secondary': '#D1D1D1', 'text-tertiary': '#A8A8A8',
                        'article-bg': 'rgba(20, 20, 22, 0.93)', 
                        'writings-card-bg': 'rgba(25, 15, 40, 0.88)',
                        'writings-card-hover-bg': 'rgba(45, 35, 60, 0.96)',
                        'dark-purple-bg': '#1a0a2e',
                        'hover-highlight': 'rgba(146, 114, 206, 0.1)',
                        'brand-purple': '#9272CE', 'brand-hover': '#AE8BD5',
                        'brand-light-purple': '#CBB8E8', 'brand-dark': '#050505',
                        'brand-light': '#FFFFFF', 'brand-gray': '#D1D1D1', 'brand-text': '#A8A8A8',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'], serif: ['Baloo Bhai 2', 'cursive'],
                        lato: ['Lato', 'sans-serif'], outfit: ['Outfit', 'sans-serif'],
                        nunito: ['Nunito', 'sans-serif'], 'fuzzy-bubbles': ['Fuzzy Bubbles', 'cursive'],
                        verdana: ['Verdana', 'sans-serif'], 'trebuchet': ['Trebuchet MS', 'sans-serif'],
                    },
                }
            }
        };
    </script>

    <style>
        html { scroll-behavior: smooth; }
        body {
            background-color: #0f0a19; color: #D1D1D1; font-family: 'Inter', sans-serif;
            overflow-x: hidden; line-height: 1.6; font-size: 16px;
        }
        /* Hyperspeed Canvas background */
        #hyperspeed-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; background-color: #07040e; }
        .bg-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle at 50% 30%, rgba(146, 114, 206, 0.03), rgba(15, 10, 25, 0.85) 70%); z-index: -5; pointer-events:none; }

        .page-section { /* ... Same ... */ } @keyframes fadeInPage { /* ... Same ... */ }
        /* General Typography & Header Styles (Keep these from your working version) */
        /* Paste them here... */
        .page-section { display: none; animation: fadeInPage 0.7s ease-out forwards; }
        .page-section.active-section { display: block; }
        @keyframes fadeInPage { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        h1, h2, h3, h4, h5, h6 { color: #ffffff; font-weight: 700; }
        .font-serif { font-family: 'Baloo Bhai 2', cursive; }
        .font-outfit { font-family: 'Outfit', sans-serif; }
        .gradient-text { background: linear-gradient(90deg, #FFFFFF, #CBB8E8, #9272CE, #CBB8E8, #FFFFFF); background-size: 300% auto; background-clip: text; -webkit-background-clip: text; color: transparent; animation: gradientTextAnim 8s linear infinite; display: inline-block; }
        @keyframes gradientTextAnim { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .typed-cursor { display: inline-block; width: 2px; background-color: #9272CE; margin-left: 4px; animation: pulseCursor 1s infinite; vertical-align: text-bottom; }
        #home-content h1 .typed-cursor { height: 1em; background-color: #CBB8E8; }
        #home-content blockquote .typed-cursor { background-color: #A8A8A8; }
        #typewriter .typed-cursor { background-color: #D1D1D1; height: 1.1em;}
        #main-heading-text .typed-cursor { height: 1.1em; }
        #blockquote-text .typed-cursor { height: 1.1em; }
        @keyframes pulseCursor { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        #typewriter { min-height: 3em; display: inline-block; width: 100%; }
        #main-heading-text { min-height: 1.2em; display: inline-block; }
        #blockquote-text { min-height: 4em; display: inline-block; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: rgba(9, 6, 19, 0.8); }
        ::-webkit-scrollbar-thumb { background: rgba(146, 114, 206, 0.5); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(146, 114, 206, 0.7); }
        .main-header { position: sticky; top: 0; left: 0; width: 100%; background-color: rgba(9, 6, 19, 0.85); backdrop-filter: blur(10px); z-index: 50; border-bottom: 1px solid rgba(146, 114, 206, 0.1); box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .main-header .nav-logo { font-family: 'Baloo Bhai 2', cursive; transition: color 0.3s ease; }
        .main-header .nav-logo:hover { color: #9272CE; }
        .desktop-nav a { position: relative; display: inline-block; transition: color 0.3s ease; }
        .desktop-nav a::after { content: ''; position: absolute; bottom: -3px; left: 0; width: 0; height: 1.5px; background-color: #9272CE; transition: width 0.3s ease; }
        .desktop-nav a:hover::after { width: 100%; }
        .desktop-nav a:hover, .desktop-nav a.active { color: #9272CE; }
        .desktop-nav a.active::after { width: 100%; }
        .nav-toggle-btn { background: none; border: none; padding: 0.5rem; cursor: pointer; z-index: 60; }
        .nav-toggle-btn svg { stroke: #ffffff; transition: stroke 0.3s ease; }
        .nav-toggle-btn:hover svg { stroke: #9272CE; }
        .mobile-menu { display: none; position: absolute; top: 100%; left: 0; width: 100%; background-color: rgba(9, 6, 19, 0.95); backdrop-filter: blur(8px); padding: 1rem 0; box-shadow: 0 10px 20px rgba(0,0,0,0.4); z-index: 55; animation: slideDownFade 0.4s ease-out forwards; }
        .mobile-menu.is-open { display: block; }
        .mobile-menu a { display: block; padding: 0.8rem 1.5rem; font-size: 1.1rem; transition: color 0.3s ease, background-color 0.3s ease; text-align: center; }
        .mobile-menu a:hover { color: #9272CE; background-color: rgba(146, 114, 206, 0.1); }
        .mobile-menu a.active { background-color: rgba(146, 114, 206, 0.1); font-weight: 600; color: #9272CE; }
        @keyframes slideDownFade { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .desktop-nav a[target="_blank"]::after, .mobile-menu a[target="_blank"]::after { content: ' \2197'; font-size: 0.7em; vertical-align: super; display: inline-block; margin-left: 2px; opacity: 0.7; width: auto !important; height: auto !important; background: none !important; }


        /* --- Home Section Styles (Small Circular Profile Image) --- */
        #heroSection {
            text-align: center;
            padding-top: 1rem; /* More space from header */
            min-height: 70vh;
            display: flex; flex-direction: column; justify-content: center;
        }
        #hero-circular-profile-image-container {
            margin-bottom: 1.5rem; /* Space below image */
        }
        #hero-circular-profile-image {
            width: 130px; /* Adjust size as needed */
            height: 130px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid rgba(146, 114, 206, 0.4); /* accent/40 */
            box-shadow: 0 0 20px rgba(146, 114, 206, 0.25);
            display: block;
            margin: 0 auto;
            opacity: 0; /* Initial state for animation */
            transform: scale(0.8) translateY(10px);
            transition: opacity 0.8s ease-out 0.2s, transform 0.8s ease-out 0.2s;
        }

        /* Home Cards & Links (from original combined version) */
        /* ... (Same as previous correct version) ... */
        #home-content .quote { position: relative; border-left: 3px solid #9272CE; margin-top: 1.5rem; } 
        #home-content .quote::before { content: '"'; position: absolute; top: -20px; left: 10px; font-size: 5rem; color: rgba(146, 114, 206, 0.1); font-family: 'Inter', sans-serif; font-weight: 700; }
        #home-content .card { transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); background: rgba(15, 10, 25, 0.75); border: 1px solid rgba(146, 114, 206, 0.2); }
        #home-content .card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(146, 114, 206, 0.1), transparent); transform: translateX(-100%); transition: transform 0.8s ease; pointer-events: none; }
        #home-content .card:hover { box-shadow: 0 15px 30px rgba(9, 6, 19, 0.6), 0 0 20px rgba(146, 114, 206, 0.35); border-color: rgba(146, 114, 206, 0.45); }
        #home-content .card:hover::before { transform: translateX(100%); }
        #home-content .hover-link { position: relative; display: inline-block; }
        #home-content .hover-link::after { content: ''; position: absolute; bottom: -2px; left: 0; width: 0; height: 1px; background-color: #9272CE; transition: width 0.3s ease; }
        #home-content .hover-link:hover::after { width: 100%; }
        .static-image-container { display: block; margin: 2.5rem auto 0 auto; width: fit-content; opacity: 0.8; transition: opacity 0.3s ease; z-index: 5; }
        .static-image { width: 8rem; height: 8rem; cursor: pointer; transition: transform 0.3s ease; }
        .static-image:hover { transform: scale(1.1); }


        /* Writings Section Styles (Stable base from earlier versions) */
        /* ... (Same as previous correct version, ensure .post-content-html styles are correct for line spacing) ... */
        #writings-content { font-size: 17px; }
        #writings-content .text-hover-scale { transition: transform 0.25s ease-out; display: inline-block; }
        #writings-content .text-hover-scale:hover { transform: scale(1.03); }
        .writing-preview-card { background-color: var(--card-bg, rgba(25, 15, 40, 0.9)); backdrop-filter: blur(7px); border-radius: 0.75rem; padding: 2rem; border: 1px solid rgba(146, 114, 206, 0.25); display: flex; flex-direction: column; transition: transform 0.3s ease-out, box-shadow 0.4s ease-out, border-color 0.4s ease-out, background-color 0.3s ease; box-shadow: 0 6px 18px rgba(0,0,0, 0.35), 0 0 8px 1px rgba(146, 114, 206, 0.2); }
        .writing-preview-card:hover { transform: translateY(-10px) scale(1.03); background-color: var(--card-hover-bg, rgba(45, 35, 60, 0.97)); animation: cardGlowWritings 1.8s ease-in-out infinite alternate; }
        @keyframes cardGlowWritings { 0% { box-shadow: 0 0 10px 2px rgba(146, 114, 206, 0.25), 0 6px 18px rgba(0,0,0, 0.35); border-color: rgba(174, 139, 213, 0.35); } 50% { box-shadow: 0 0 22px 5px rgba(146, 114, 206, 0.4), 0 10px 28px rgba(0, 0, 0, 0.3); border-color: rgba(174, 139, 213, 0.65); } 100% { box-shadow: 0 0 10px 2px rgba(146, 114, 206, 0.25), 0 6px 18px rgba(0,0,0, 0.35); border-color: rgba(174, 139, 213, 0.35); } }
        .writing-preview-card h3 { color: #FFFFFF; font-size: 1.55rem; font-weight: 600; margin-bottom: 0.75rem; font-family: 'Outfit', sans-serif; }
        .writing-preview-card .post-meta-info { font-size: 0.9rem; color: #CBB8E8; margin-bottom: 1.25rem; font-family: 'Lato', sans-serif; opacity: 0.9; }
        .writing-preview-card .excerpt { color: #D1D1D1; font-size: 1.05rem; line-height: 1.65; flex-grow: 1; margin-bottom: 1.5rem; }
        .writing-preview-card a.read-more-link { display: inline-block; background: none; border: none; padding: 0; color: #9272CE; font-weight: 500; text-decoration: none; align-self: flex-start; cursor: pointer; transition: color 0.3s ease; font-size: 1.05rem; margin-top: auto; }
        .writing-preview-card a.read-more-link:hover { color: #AE8BD5; text-decoration: underline; }
        #full-articles-container { display: block; margin-top: 2rem; }
        #full-articles-container article { display: none; background-color: rgba(20, 20, 22, 0.94); backdrop-filter: blur(10px); border-radius: 0.75rem; padding: 2.5rem 2rem; margin-bottom: 3rem; box-shadow: 0 10px 40px rgba(0,0,0, 0.6), inset 0 1px 3px rgba(146, 114, 206, 0.1); border: 1px solid rgba(146, 114, 206, 0.3); border-top: 5px solid #9272CE; opacity: 0; }
        #full-articles-container article:target { display: block !important; opacity: 1 !important; animation: fadeInArticle 0.6s ease-out forwards; }
        @keyframes fadeInArticle { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        #writings-grid-container:has(~ #full-articles-container article:target) { display: none; }
        hr.separator:has(~ #full-articles-container article:target) { display: none; }
        #full-articles-container h2 { color: #9272CE; margin-bottom: 0.75rem; font-size: 2.1rem; font-weight: 700; font-family: 'Outfit', sans-serif; line-height: 1.3; }
        #full-articles-container .post-meta-info { font-size: 0.95rem; color: #CBB8E8; margin-bottom: 2.5rem; font-family: 'Lato', sans-serif; opacity: 0.85; }
        a.back-button { display: inline-block; margin-top: 2.5rem; padding: 0.7rem 1.4rem; background-color: #9272CE; color: #FFFFFF; border: none; border-radius: 0.5rem; font-weight: 500; cursor: pointer; transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease; box-shadow: 0 3px 10px rgba(146, 114, 206, 0.2); font-size: 1rem; text-decoration: none; }
        a.back-button:hover { background-color: #AE8BD5; transform: scale(1.05) translateY(-2px); box-shadow: 0 8px 20px rgba(146, 114, 206, 0.3); }
        hr.separator { border: none; height: 2px; background-image: linear-gradient(to right, transparent, #9272CE, #AE8BD5, #9272CE, transparent); margin-top: 3rem; margin-bottom: 3rem; opacity: 0.6; display: block; }
        
        .post-content-html {
            white-space: pre-line; 
            text-align: left;
            line-height: 1.7; /* Adjusted for poems - can be more specific if needed */
        }
        .post-content-html p, .post-content-html blockquote, .post-content-html span, .post-content-html div, .post-content-html b, .post-content-html strong, .post-content-html i, .post-content-html em, .post-content-html u, .post-content-html a { 
            font-family: inherit; font-size: 1.1rem; 
            /* line-height is now on parent .post-content-html */
            color: #D1D1D1; 
            background-color: transparent !important; 
            margin: 0 0 0.8em 0; /* Reduced bottom margin for tighter poem lines */
            font-weight: normal; font-style: normal; 
            text-decoration: none; word-wrap: break-word; border-radius: 3px; 
        }
        .post-content-html br {
            content: "";
            display: block;
            margin-bottom: 0.1em; /* Small gap for <br>, adjust as needed for poem pacing */
        }
        /* Other .post-content-html child styles (bold, italic, links, etc.) - Keep as before */
        .post-content-html span { margin: 0; display: inline; }
        .post-content-html [style*="font-family: Outfit"] { font-family: 'Outfit', sans-serif; } 
        .post-content-html [style*="font-family: Nunito"] { font-family: 'Nunito', sans-serif; } 
        .post-content-html [style*="font-family: Fuzzy Bubbles"] { font-family: 'Fuzzy Bubbles', cursive; } 
        .post-content-html [style*="font-family: verdana"] { font-family: 'Verdana', sans-serif; } 
        .post-content-html [style*="font-family: trebuchet"] { font-family: 'Trebuchet MS', sans-serif; }
        .post-content-html b, .post-content-html strong, .post-content-html [style*="font-weight: bold"] { font-weight: 700; } 
        .post-content-html i, .post-content-html em, .post-content-html [style*="font-style: italic"] { font-style: italic; } 
        .post-content-html u { text-decoration: underline; } 
        .post-content-html a { color: #9272CE; text-decoration: underline; transition: color 0.2s ease; display: inline; } 
        .post-content-html a:hover { color: #AE8BD5; }
        .post-content-html p[style*="text-align: center;"], 
        .post-content-html div[style*="text-align: center;"], 
        .post-content-html blockquote[style*="text-align: center;"] { 
            text-align: center !important; margin-left: auto; margin-right: auto; 
        }
        .post-content-html blockquote { border-left: 4px solid #9272CE; padding: 1em 1.75rem; margin-left: 0; margin-right: 0; font-style: italic; color: #A8A8A8; background-color: rgba(146, 114, 206, 0.05); }
        .post-content-html blockquote blockquote { margin-top: 1em; margin-left: 1.5rem; border-left-color: #AE8BD5; padding-left: 1rem; background-color: rgba(174, 139, 213, 0.05); }
        .post-content-html blockquote p { margin-bottom: 0.75em; }
        .post-content-html img { max-width: 100%; height: auto; display: block; margin: 2.5rem auto; border-radius: 0.75rem; box-shadow: 0 6px 20px rgba(0,0,0,0.4); transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .post-content-html img:hover { transform: scale(1.03); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .post-content-html .separator { display: none; }
        @layer utilities { .line-clamp-3 { overflow: hidden; display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 3; } .line-clamp-4 { overflow: hidden; display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 4; } }


        /* Glitch Button, Footer, Secret Game, Progress Bar (Keep from previous working version) */
        /* ... Paste these styles ... */
        .glitch-button { position: relative; display: inline-block; cursor: pointer; padding: 0.75rem 1.5rem; text-decoration: none; overflow: hidden; transition: transform 0.1s ease-out; -webkit-user-select: none; -ms-user-select: none; user-select: none; }
        .glitch-button .btn-text { position: relative; z-index: 1; }
        .glitch-button::before, .glitch-button::after { content: attr(data-text); position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: inherit; color: inherit; padding: inherit; overflow: hidden; transition: transform 0.3s cubic-bezier(0.75, 0, 0.25, 1), opacity 0.3s ease; opacity: 0; }
        .glitch-button:hover::before { transform: translate(-3px, -2px) skewX(-5deg); text-shadow: 2px 0px #FF00FF; opacity: 0.8; animation: glitchEffectBefore 0.2s infinite alternate; }
        .glitch-button:hover::after { transform: translate(3px, 2px) skewX(5deg); text-shadow: -2px 0px #00FFFF; opacity: 0.8; animation: glitchEffectAfter 0.2s infinite alternate-reverse; }
        .glitch-button:active { transform: scale(0.97); }
        @keyframes glitchEffectBefore { 0% { clip-path: inset(10% 0 70% 0); } 50% { clip-path: inset(40% 0 20% 0); } 100% { clip-path: inset(75% 0 5% 0); } }
        @keyframes glitchEffectAfter { 0% { clip-path: inset(60% 0 25% 0); } 50% { clip-path: inset(15% 0 55% 0); } 100% { clip-path: inset(50% 0 10% 0); } }
        #home-content .view-all-writings-btn { background-color: #9272CE; color: #FFFFFF; font-weight: 500; border-radius: 0.5rem; }
        #home-content .view-all-writings-btn:hover { background-color: #AE8BD5; }
        .main-footer { background-color: rgba(9, 6, 19, 0.7); border-top: 1px solid rgba(146, 114, 206, 0.1); padding: 2rem 0; margin-top: 4rem; text-align: center; }
        #secret-game-trigger { cursor: cell; display: inline-block; opacity: 0.5; transition: opacity 0.3s; }
        #secret-game-trigger:hover { opacity: 1; }
        #secret-game-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(9, 6, 19, 0.95); backdrop-filter: blur(5px); z-index: 1000; display: none; flex-direction: column; align-items: center; justify-content: center; animation: fadeInGameModal 0.5s ease-out forwards; }
        @keyframes fadeInGameModal { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        #matter-canvas { background-color: rgba(15, 10, 25, 0.5); border: 1px solid rgba(146, 114, 206, 0.3); }
        #close-game-button { margin-top: 20px; padding: 10px 20px; background-color: #9272CE; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: 500; transition: background-color 0.3s, transform 0.2s; }
        #close-game-button:hover { background-color: #AE8BD5; transform: scale(1.05); }
        .progress-container { position: fixed; top: 0; left: 0; width: 100%; height: 3px; z-index: 100; }
        .progress-bar { height: 3px; background: linear-gradient(90deg, #9272CE, #AE8BD5); width: 0%; }

    </style>
</head>
<body>
    <canvas id="hyperspeed-canvas"></canvas>
    <!-- HTML Structure (Progress Bar, BG Overlay, Header, Page Container, Footer, Modal) - Same as before -->
    <div class="progress-container"> <div class="progress-bar" id="progressBar"></div> </div> <div class="bg-overlay"></div>
    <header class="main-header"> <div class="container mx-auto px-6 py-4"> <div class="flex justify-between items-center"> <a href="#home" class="nav-logo text-2xl lg:text-3xl font-bold text-text-primary">a-g-r-a-j</a> <button id="nav-toggle" class="nav-toggle-btn md:hidden" aria-label="Toggle Menu" aria-expanded="false"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" /></svg> </button> <nav class="desktop-nav hidden md:flex space-x-8 text-text-primary items-center"> <a href="https://www.blogger.com/profile/06675668817383737660" target="_blank" rel="noopener noreferrer">About Me</a> <a href="https://www.reddit.com/user/Federal_Anywhere_559/" target="_blank" rel="noopener noreferrer">Contact Me</a> <a href="#writings" data-navlink="writings">Writings</a> <a href="#home" data-navlink="home" class="active">Home</a> </nav> </div> <nav id="mobile-menu" class="mobile-menu md:hidden"> <a href="https://www.blogger.com/profile/06675668817383737660" target="_blank" rel="noopener noreferrer">About Me</a> <a href="https://www.reddit.com/user/Federal_Anywhere_559/" target="_blank" rel="noopener noreferrer">Contact Me</a> <a href="#writings" data-navlink="writings">Writings</a> <a href="#home" data-navlink="home" class="active">Home</a> </nav> </div> </header>
    <div id="page-container"> <section id="home-content" class="page-section"> <main class="container mx-auto px-4 md:px-6 pt-16 md:pt-24 pb-16"> <section class="opacity-0" id="heroSection">  <div id="hero-circular-profile-image-container"> <img src="agraj_profile.jpg" alt="Agraj Dubey" id="hero-circular-profile-image"> </div> <div id="home-hero-text-content" class="w-full"> <h1 class="gradient-text text-5xl md:text-6xl lg:text-7xl font-bold mb-6 tracking-tight font-serif"> <span id="main-heading-text"></span> </h1> <p class="text-xl md:text-2xl text-text-secondary mb-10 md:mb-12 italic" id="typewriter"></p> <blockquote class="quote max-w-xl mx-auto text-lg md:text-xl bg-darker/80 backdrop-blur-sm p-6 rounded-lg shadow-xl text-text-tertiary border-l-4 border-accent"> "<span id="blockquote-text"></span>" </blockquote> </div> </section> <section class="mb-16 opacity-0" id="writingsSectionHome"> <h2 class="text-3xl md:text-4xl font-bold text-center text-text-primary mt-16 mb-12">Recent Writings</h2> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="home-recent-writings-grid"></div> <div class="text-center mt-12 md:mt-16"> <a href="#writings" class="view-all-writings-btn glitch-button" data-text="View All Writings"> <span class="btn-text">View All Writings</span> </a> </div> <div id="staticImageContainerHome" class="static-image-container"> <img src="FrierenRing.png" alt="Ring Image" id="staticImageHome" class="static-image"> </div> </section> </main> </section> <section id="writings-content" class="page-section"> <main class="container mx-auto px-6 py-16 md:py-20 min-h-screen"> <div class="text-center mb-12 md:mb-16 pt-8"> <h1 class="text-4xl md:text-5xl font-bold text-text-primary font-outfit">My Writings</h1> </div> <section id="writings-grid-container" class="mb-12 md:mb-20 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8"></section> <hr class="separator"> <section id="full-articles-container"> <div class="full-articles-content max-w-4xl mx-auto" id="full-articles-dynamic-content"></div> </section> </main> </section> </div>
    <footer class="main-footer relative z-10"> <div class="container mx-auto px-6"> <p class="text-text-tertiary">¬© <span id="currentYear"></span> agraj. All rights reserved. <span id="secret-game-trigger" title="?">üïπÔ∏è</span> </p> </div> </footer>
    <div id="secret-game-modal"> <canvas id="matter-canvas"></canvas> <button id="close-game-button" class="glitch-button" data-text="Close Game"><span class="btn-text">Close Game</span></button> </div>

    <script>
        const APP_CONFIG = { /* ... (Same as before, including ROTATING_TEXT_HOME, DEFAULT_TITLES, POSTS_JSON_PATH) ... */ };
        // Paste the full APP_CONFIG from the previous response here
         APP_CONFIG.ROTATING_TEXT_HOME = {
             'typewriter': { texts: ["Cause no one listens, so I write instead üòé"], typeSpeed: 80, deleteSpeed: 50, pauseDuration: 3000 },
             'main-heading-text': { texts: ["agraj", "„Ç¢„Ç∞„É©„Ç∏", "‡§Ö‡§ó‡•ç‡§∞‡§ú", "Œ±Œ≥œÅŒ±Œæ"], typeSpeed: 100, deleteSpeed: 60, pauseDuration: 2500 },
             'blockquote-text': { texts: ["If determinism holds, there's a chance I exit early‚Äîsomething dramatic. So I leave fragments of myself here‚Äîat least the algorithm remembers me better than my family willüòí", "Is free will an illusion, or is the illusion the only free will we have?", "Perhaps the 'fragments' are the only coherent parts left.", "What if the algorithm forgets too?", "Maybe exiting early isn't dramatic, just... efficient.", "Family remembers differently. Algorithms remember precisely. Which is better?", "The universe is indifferent, but the code persists. For now.", "Do androids dream of electric sheep? Do algorithms dream of better data?", "To be, or not to be, that is the computation.", "Cogito, ergo sum... I think, therefore I am... coded?"], typeSpeed: 70, deleteSpeed: 40, pauseDuration: 4500 }
        };
        APP_CONFIG.DEFAULT_TITLES = {
            home: "agraj - Portfolio",
            writings: "Writings - Agraj Dubey"
        };
        APP_CONFIG.POSTS_JSON_PATH = 'posts.json';


        function $(selector) { return document.querySelector(selector); }
        function $$(selector) { return document.querySelectorAll(selector); }

        // --- Hyperspeed Animation (WITH MOUSE PULL INTERACTION) ---
               // --- Hyperspeed Animation (WITH MOUSE PULL INTERACTION) ---
        const hyperspeedCanvas = $('#hyperspeed-canvas');
        const hsCtx = hyperspeedCanvas.getContext('2d');
        let stars = [];
        const numStars = 400;
        let mouseX = window.innerWidth / 2;
        let mouseY = window.innerHeight / 2;
        let baseSpeed = 0.008;
        const aceFlagColors = ['#000000', '#A3A3A3', '#FFFFFF', '#800080'];

        function resizeHyperspeedCanvas() {
            hyperspeedCanvas.width = window.innerWidth;
            hyperspeedCanvas.height = window.innerHeight;
            mouseX = hyperspeedCanvas.width / 2;
            mouseY = hyperspeedCanvas.height / 2;
            // Re-initialize stars on resize if their positions depend on canvas dimensions
            // or if you want a fresh distribution. For this effect, it's often good.
            // initStars(); // Optional: uncomment if you want stars to reset on resize
        }

        function initStars() {
            stars = [];
            for (let i = 0; i < numStars; i++) {
                const randomAceColor = aceFlagColors[Math.floor(Math.random() * aceFlagColors.length)];
                stars.push({
                    x: Math.random() * 2 - 1, // Normalized: -1 to 1
                    y: Math.random() * 2 - 1, // Normalized: -1 to 1
                    z: Math.random() * 1.8 + 0.2, // Initial depth
                    // Store original x, y for more stable pull calculation if needed, but current approach is fine
                    // ox: Math.random() * 2 - 1, 
                    // oy: Math.random() * 2 - 1,
                    color: randomAceColor,
                    opacity: Math.random() * 0.4 + 0.2
                });
            }
        }

        function animateHyperspeed() {
            hsCtx.clearRect(0, 0, hyperspeedCanvas.width, hyperspeedCanvas.height);
            const centerX = hyperspeedCanvas.width / 2;
            const centerY = hyperspeedCanvas.height / 2;

            // Normalize mouse position to the same conceptual space as star.x, star.y (~[-1, 1])
            // This helps make the pull effect consistent regardless of canvas size.
            const normMouseX = (mouseX - centerX) / (hyperspeedCanvas.width / 2); // Or just centerX if square
            const normMouseY = (mouseY - centerY) / (hyperspeedCanvas.height / 2); // Or just centerY

            stars.forEach(star => {
                // --- MOUSE PULL INTERACTION (New Logic) ---
                const dxToMouseNorm = normMouseX - star.x;
                const dyToMouseNorm = normMouseY - star.y;
                const distToMouseSqNorm = dxToMouseNorm * dxToMouseNorm + dyToMouseNorm * dyToMouseNorm;
                
                const interactionRadiusNormSq = 0.3 * 0.3; // Pull radius in normalized space, squared
                const pullStrength = 0.0003; // Strength of the pull, adjust for subtlety

                if (distToMouseSqNorm < interactionRadiusNormSq && distToMouseSqNorm > 0.00001) { // Check dist > 0 to avoid division by zero
                    const distNorm = Math.sqrt(distToMouseSqNorm);
                    // Force is stronger when closer
                    const forceFactor = (1 - distNorm / Math.sqrt(interactionRadiusNormSq)) * pullStrength; 
                    
                    // Nudge the star's normalized (x,y) towards the normalized mouse position
                    // The change is small each frame, creating a curve.
                    star.x += (dxToMouseNorm / distNorm) * forceFactor / star.z; // Effect less pronounced for distant stars (dividing by z)
                    star.y += (dyToMouseNorm / distNorm) * forceFactor / star.z;
                }
                // --- END MOUSE PULL INTERACTION ---


                // --- Z-axis movement and speed-up on hover (Existing Logic) ---
                const projX = centerX + (star.x / star.z) * centerX; // Projected X on screen
                const projY = centerY + (star.y / star.z) * centerY; // Projected Y on screen

                const dxMouseForSpeed = projX - mouseX;
                const dyMouseForSpeed = projY - mouseY;
                const distMouseForSpeed = Math.sqrt(dxMouseForSpeed * dxMouseForSpeed + dyMouseForSpeed * dyMouseForSpeed);
                
                let currentSpeedFactor = 1;
                const speedUpRadius = 120; // Pixel radius for Z-speed up
                if (distMouseForSpeed < speedUpRadius) {
                    currentSpeedFactor = 1 + (4.5 * (1 - distMouseForSpeed / speedUpRadius));
                }
                // --- End Z-axis speed-up ---

                star.z -= baseSpeed * currentSpeedFactor;

                // Reset star
                if (star.z <= 0.005) {
                    star.x = Math.random() * 2 - 1;
                    star.y = Math.random() * 2 - 1;
                    star.z = Math.random() * 1.8 + 0.2; // Reset further back
                    star.color = aceFlagColors[Math.floor(Math.random() * aceFlagColors.length)];
                    star.opacity = Math.random() * 0.4 + 0.2;
                }
                
                // Calculate final screen position after pull and z-movement
                const screenX = centerX + (star.x / star.z) * centerX;
                const screenY = centerY + (star.y / star.z) * centerY;
                const size = Math.max(0.3, (1 / star.z) * 2.5);
                const dynamicOpacity = Math.min(1, (star.opacity + (1 / star.z) * 0.3));

                // Draw star
                if (screenX > -size && screenX < hyperspeedCanvas.width + size && screenY > -size && screenY < hyperspeedCanvas.height + size) {
                    hsCtx.fillStyle = star.color.startsWith('#') ? `${star.color}${Math.round(dynamicOpacity * 255).toString(16).padStart(2, '0')}` : `rgba(${star.color.slice(5,-1)}, ${dynamicOpacity})`;
                    if (star.color === '#000000' && dynamicOpacity > 0.1) {
                        hsCtx.fillStyle = `rgba(50,50,50, ${dynamicOpacity * 0.5})`;
                    }
                    hsCtx.beginPath();
                    hsCtx.arc(screenX, screenY, size, 0, Math.PI * 2);
                    hsCtx.fill();
                }
            });
            requestAnimationFrame(animateHyperspeed);
        }

        hyperspeedCanvas.addEventListener('mousemove', (e) => { mouseX = e.clientX; mouseY = e.clientY; });
        hyperspeedCanvas.addEventListener('mouseleave', () => { 
            // Optionally, slowly return mouseX/Y to center or just leave it at last known position
            // For now, leaving at last known position is fine for this effect.
            // mouseX = hyperspeedCanvas.width / 2; 
            // mouseY = hyperspeedCanvas.height / 2;
        });

        // ... (rest of your JavaScript, including setupRotatingText, simpleMarkdownToHtml, loadAndRenderPosts, showMainSection, etc.)
        // Ensure all the other functions from the "content finally" version are present here.
        // For brevity, I'm not repeating them all, but they MUST be here.
    </script>
        // --- Content Rendering (simpleMarkdownToHtml from previous correct version) ---
        // (createPostPreviewCard, createFullArticleHtml, loadAndRenderPosts - Ensure these are the robust versions)
        // Paste them here
        let ALL_POST_DATA_FOR_HOME_RECENT = []; let ALL_POSTS_DATA = [];
        function simpleMarkdownToHtml(md) {
            if (typeof md !== 'string') return '';
            let html = md;
            if (html.startsWith('`') && html.endsWith('`') && !html.startsWith('```') && !html.endsWith('```')) {
                html = html.substring(1, html.length - 1);
            }
            html = html.replace(/<br\s*\/?>/gi, '[[BR_TAG]]');
            html = html.replace(/\n/g, '[[BR_TAG]]');
            html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');    
            html = html.replace(/\\\"/g, '"');
            html = html.replace(/\[\[BR_TAG\]\]/g, '<br>\n');
            html = html.replace(/(<br>\n\s*){2,}/gi, '<br>\n');
            return html;
        }
        function createPostPreviewCard(post, isForHome = false) { /* ... Same as previous successful version ... */ 
            const cardClass = isForHome ? 'card' : 'writing-preview-card';
            const delay = isForHome && ALL_POST_DATA_FOR_HOME_RECENT.length > 0 ? (ALL_POST_DATA_FOR_HOME_RECENT.indexOf(post) * 150) : 0;

            return `
                <div class="${cardClass} rounded-lg p-7 shadow-lg relative overflow-hidden" ${isForHome ? `data-delay="${delay}"` : ''}>
                    <h3 class="text-xl lg:text-2xl font-semibold text-text-primary mb-4 group ${!isForHome ? 'text-hover-scale font-outfit' : ''}">
                        <span class="${isForHome ? 'hover:text-accent' : ''} transition-all duration-300 inline-block">${post.title}</span>
                    </h3>
                    ${!isForHome ? `<div class="post-meta-info">${new Date(post.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>` : ''}
                    <div class="mb-5"><p class="text-text-secondary line-clamp-${isForHome ? 3 : 4} ${!isForHome ? 'excerpt' : ''}">${post.excerpt}</p></div>
                    <a href="#${post.id}" class="${isForHome ? 'text-accent hover:text-accent-hover font-medium inline-flex items-center hover-link' : 'read-more-link glitch-button'}" data-text="Read More ‚Üí">
                        <span class="${!isForHome ? 'btn-text' : ''}">Read More ${!isForHome ? '‚Üí' : ''}</span>
                        ${isForHome ? '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" /></svg>' : ''}
                    </a>
                </div>
            `;
        }
        function createFullArticleHtml(post) { /* ... Same as previous successful version ... */ 
            const htmlContent = simpleMarkdownToHtml(post.contentMarkdown); 
            return `
                <article id="${post.id}" tabindex="-1">
                    <h2 class="text-hover-scale">${post.title}</h2>
                    <div class="post-meta-info">Published: ${new Date(post.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
                    ${post.image ? `<img src="${post.image}" alt="${post.imageAlt || post.title}" class="my-8 rounded-lg shadow-lg mx-auto max-w-full md:max-w-2xl" loading="lazy">` : ''}
                    <div class="post-content-html">${htmlContent}</div>
                    <a href="#writings" class="back-button mt-8 glitch-button" data-text="‚Üê Back to Writings"><span class="btn-text">‚Üê Back to Writings</span></a>
                </article>
            `;
        }
        async function loadAndRenderPosts() { /* ... Same as previous successful version with console logs ... */ 
            console.log("Attempting to load posts...");
            try {
                const response = await fetch(APP_CONFIG.POSTS_JSON_PATH);
                console.log("Fetch response status:", response.status);
                if (!response.ok) { throw new Error(`HTTP error! status: ${response.status}, path: ${APP_CONFIG.POSTS_JSON_PATH}`); }
                ALL_POSTS_DATA = await response.json();
                console.log("Posts data loaded:", ALL_POSTS_DATA.length, "posts");
                ALL_POSTS_DATA.sort((a, b) => new Date(b.date) - new Date(a.date)); 
                ALL_POST_DATA_FOR_HOME_RECENT = ALL_POSTS_DATA.slice(0, 3);
                const homeGrid = $('#home-recent-writings-grid');
                if (homeGrid) {
                    if (ALL_POST_DATA_FOR_HOME_RECENT.length > 0) { homeGrid.innerHTML = ALL_POST_DATA_FOR_HOME_RECENT.map(post => createPostPreviewCard(post, true)).join(''); } 
                    else { homeGrid.innerHTML = '<p class="text-text-secondary col-span-full text-center">No recent writings to display.</p>'; }
                    setupHomeCardHoverEffects(); setupHomeScrollAnimations(); 
                }
                const writingsGrid = $('#writings-grid-container');
                if (writingsGrid) {
                     if (ALL_POSTS_DATA.length > 0) { writingsGrid.innerHTML = ALL_POSTS_DATA.map(post => createPostPreviewCard(post, false)).join(''); } 
                     else { writingsGrid.innerHTML = '<p class="text-text-secondary col-span-full text-center">No writings available.</p>'; }
                }
                const fullArticlesTarget = $('#full-articles-dynamic-content');
                 if (fullArticlesTarget) {  fullArticlesTarget.innerHTML = ALL_POSTS_DATA.map(post => createFullArticleHtml(post)).join(''); }
            } catch (error) {
                console.error("ERROR in loadAndRenderPosts:", error);
                if ($('#home-recent-writings-grid')) $('#home-recent-writings-grid').innerHTML = '<p class="text-text-secondary col-span-full text-center">Error: Could not load recent writings.</p>';
                if ($('#writings-grid-container')) $('#writings-grid-container').innerHTML = '<p class="text-text-secondary col-span-full text-center">Error: Could not load writings.</p>';
            }
        }


        // --- Other JS functions (Rotating Text, Menu, Scroll, Image Click, Card Hovers, Scroll Animations, Router, Secret Game etc.) ---
        // (These should be the robust versions from a stable previous iteration)
        // Paste them here
        let rotatingTextInstances = {};
        function setupRotatingText(elementId, config) { /* ... */ 
            if (rotatingTextInstances[elementId]) { return; }
            const element = document.getElementById(elementId);
            if (!element) { return; }
            let currentIndex = -1, isBusy = false, cycleTimeout = null, isVisible = false;
            const runOnce = (elementId === 'typewriter');
            element.textContent = ''; 
            function typeWriterInternal(text, callback) {
                let i = 0; isBusy = true;
                function type() {
                    if (!isVisible || !isBusy) { isBusy = false; if (!isVisible) element.textContent = ''; return; }
                    if (i < text.length) {
                        element.textContent += text.charAt(i); i++;
                        setTimeout(type, config.typeSpeed);
                    } else {
                        if (element.querySelector('.typed-cursor')) element.removeChild(element.querySelector('.typed-cursor'));
                        const cursor = document.createElement('span'); cursor.className = 'typed-cursor'; element.appendChild(cursor);
                        isBusy = false; if (callback) callback();
                    }
                } type();
            }
            function deleteWriterInternal(callback) {
                if (runOnce && element.textContent.length > 0) { if (callback) callback(); return; }
                let text = element.textContent;
                const existingCursor = element.querySelector('.typed-cursor');
                if (existingCursor) element.removeChild(existingCursor);
                text = element.textContent; 
                let i = text.length; isBusy = true;
                function del() {
                    if (!isVisible || !isBusy) { isBusy = false; if (!isVisible) element.textContent = ''; return; }
                    if (i > 0) {
                        element.textContent = text.substring(0, i - 1); i--;
                        if (!element.querySelector('.typed-cursor') && element.textContent.length > 0) {
                           const cursor = document.createElement('span'); cursor.className = 'typed-cursor'; element.appendChild(cursor);
                        } setTimeout(del, config.deleteSpeed);
                    } else {
                        const finalCursor = element.querySelector('.typed-cursor'); if (finalCursor) element.removeChild(finalCursor);
                        element.textContent = ''; isBusy = false; if (callback) callback();
                    }
                } del();
            }
            function scheduleCycle(delay) { if (runOnce) return; clearTimeout(cycleTimeout); cycleTimeout = setTimeout(() => { if(isVisible) startCycle(); }, delay); }
            function startCycle() {
                if (runOnce || isBusy || !isVisible) return;
                deleteWriterInternal(() => {
                    if (!isVisible) return; let nextIndex;
                    do { nextIndex = Math.floor(Math.random() * config.texts.length); }
                    while (nextIndex === currentIndex && config.texts.length > 1);
                    currentIndex = nextIndex; const nextText = config.texts[currentIndex];
                    element.textContent = ''; typeWriterInternal(nextText, () => scheduleCycle(config.pauseDuration));
                });
            }
            let initialized = false;
            const intersectionObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const wasVisible = isVisible; isVisible = entry.isIntersecting;
                    if (isVisible && !wasVisible) {
                        if (!initialized) {
                            initialized = true;
                            currentIndex = runOnce ? 0 : (elementId === 'main-heading-text' ? 0 : Math.floor(Math.random() * config.texts.length));
                            const firstText = config.texts[currentIndex];
                            element.textContent = ''; typeWriterInternal(firstText, () => { if (!runOnce) scheduleCycle(config.pauseDuration); });
                        } else { 
                            if (!isBusy) {
                                if (runOnce) { if(element.textContent === '') { element.textContent = ''; typeWriterInternal(config.texts[0], () => {}); }
                                } else { element.textContent = ''; scheduleCycle(100); }
                            }
                        }
                    } else if (!isVisible && wasVisible) { clearTimeout(cycleTimeout); isBusy = false; }
                });
            }, { threshold: 0.1 });
            intersectionObserver.observe(element);
            rotatingTextInstances[elementId] = { observer: intersectionObserver, element: element };
        }
        function setupMobileMenu() { /* ... */ 
            const navToggle = $('#nav-toggle'); const mobileMenu = $('#mobile-menu');
            if (navToggle && mobileMenu) {
                navToggle.addEventListener('click', () => { const isOpen = mobileMenu.classList.toggle('is-open'); navToggle.setAttribute('aria-expanded', String(isOpen)); });
                $$('#mobile-menu a').forEach(link => { link.addEventListener('click', () => { mobileMenu.classList.remove('is-open'); navToggle.setAttribute('aria-expanded', 'false'); }); });
            }
        }
        function setupScrollProgressBar() { /* ... */ 
            const progressBar = $("#progressBar"); if (!progressBar) return;
            window.addEventListener('scroll', () => { const winScroll = document.body.scrollTop || document.documentElement.scrollTop; const height = document.documentElement.scrollHeight - document.documentElement.clientHeight; const scrolled = height > 0 ? (winScroll / height) * 100 : 0; progressBar.style.width = scrolled + "%"; }, { passive: true });
        }
        function setupStaticImageClick() { /* ... */
            const imageElement = $('#staticImageHome'); if (!imageElement) return;
            const videoUrls = [ 'https://www.youtube.com/watch?v=dQw4w9WgXcQ', 'https://www.youtube.com/watch?v=-jGBp5HBLFs', 'https://www.youtube.com/shorts/2Dv2hO3rYVg', 'https://www.youtube.com/watch?v=x6YcdgB9e48', 'https://www.youtube.com/shorts/D-kkjR0NyGg', 'https://www.youtube.com/shorts/LFsS-9lT0Rk', 'https://www.youtube.com/shorts/TTU1g8IU22I' ];
            imageElement.addEventListener('click', () => { const randomIndex = Math.floor(Math.random() * videoUrls.length); window.open(videoUrls[randomIndex], '_blank'); });
        }
        function setupHomeCardHoverEffects() { /* ... */ 
             $$('#home-content .card').forEach(card => {
                card.addEventListener('mousemove', (e) => { const rect = card.getBoundingClientRect(); const x = e.clientX - rect.left; const y = e.clientY - rect.top; const centerX = rect.width / 2; const centerY = rect.height / 2; const rotateX = (y - centerY) / 20; const rotateY = (centerX - x) / 20; card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateZ(20px)`; });
                card.addEventListener('mouseleave', () => { card.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) translateZ(0px)'; });
                card.querySelectorAll('a').forEach(link => { link.addEventListener('click', (e) => e.stopPropagation()); });
            });
        }
        function setupHomeScrollAnimations() { /* ... */ 
             const observerOptions = { threshold: 0.1, rootMargin: '0px 0px -30px 0px' };
             const observer = new IntersectionObserver((entries, obs) => {
                 entries.forEach(entry => {
                     const isRotatingText = Object.keys(APP_CONFIG.ROTATING_TEXT_HOME).includes(entry.target.id);
                     if (entry.isIntersecting) { if (!isRotatingText) { entry.target.style.opacity = '1'; entry.target.style.transform = entry.target.dataset.initialTransform || 'translateY(0)'; obs.unobserve(entry.target); } }
                 });
             }, observerOptions);
             const heroSection = $('#heroSection'); if (heroSection) { heroSection.style.opacity = '0'; heroSection.style.transform = 'translateY(20px)'; heroSection.dataset.initialTransform = 'translateY(0)'; heroSection.style.transition = 'opacity 0.8s ease-out, transform 0.8s ease-out'; observer.observe(heroSection); }
             const writingsSectionHome = $('#writingsSectionHome'); if (writingsSectionHome) { writingsSectionHome.style.opacity = '0'; writingsSectionHome.style.transform = 'translateY(20px)'; writingsSectionHome.dataset.initialTransform = 'translateY(0)'; writingsSectionHome.style.transition = 'opacity 0.8s ease-out, transform 0.8s ease-out'; observer.observe(writingsSectionHome); }
             $$('#home-content .card').forEach(card => { 
                 const delay = parseInt(card.getAttribute('data-delay')) || 0; card.style.opacity = '0'; card.style.transform = 'perspective(1000px) rotateX(10deg) rotateY(10deg) translateZ(-20px)'; card.dataset.initialTransform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) translateZ(0px)'; card.style.transition = `opacity 0.8s ease-out ${delay}ms, transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) ${delay}ms`; observer.observe(card);
             });
        }
        function animateCircularProfileImage() { // For the small circular image
            const heroImage = $('#hero-circular-profile-image');
            if (heroImage) {
                 // CSS handles initial opacity:0 and transform
                heroImage.style.opacity = '1'; 
                heroImage.style.transform = 'scale(1) translateY(0px)';
            }
        }
        let currentMainSection = null;
        let lastClickedReadMoreLink = null;
        function showMainSection(sectionId) { /* ... */ 
            const previouslyActiveSection = $('.page-section.active-section');
            if (previouslyActiveSection) previouslyActiveSection.classList.remove('active-section');
            const targetSection = $(`#${sectionId}`);
            if (targetSection) {
                targetSection.classList.add('active-section');
                currentMainSection = sectionId;
                $$('.desktop-nav a, .mobile-menu a').forEach(navLink => {
                    navLink.classList.remove('active');
                    const navTarget = navLink.getAttribute('href').substring(1);
                    if ((sectionId === 'home-content' && navTarget === 'home') || (sectionId === 'writings-content' && navTarget === 'writings')) {
                        navLink.classList.add('active');
                    }
                });
                if (sectionId === 'home-content') {
                    animateCircularProfileImage(); // Animate the circular profile image
                    for (const elId in APP_CONFIG.ROTATING_TEXT_HOME) {
                        setupRotatingText(elId, APP_CONFIG.ROTATING_TEXT_HOME[elId]);
                    }
                }
                window.scrollTo({ top: 0, behavior: 'auto' });
            }
        }
        function handleMainRouteChange() { /* ... */ 
            let mainSectionTarget = 'home-content';
            let articleDetailHash = '';
            const currentFullHash = window.location.hash;

            if (currentFullHash.startsWith('#post-')) {
                mainSectionTarget = 'writings-content'; articleDetailHash = currentFullHash;
            } else if (currentFullHash === '#writings') {
                mainSectionTarget = 'writings-content';
            } else if (currentFullHash === '#home' || !currentFullHash) {
                mainSectionTarget = 'home-content'; if (!currentFullHash) window.location.hash = 'home';
            } else { window.location.hash = 'home'; return; }

            if (currentMainSection !== mainSectionTarget) {
                 showMainSection(mainSectionTarget);
            } else if (mainSectionTarget === 'writings-content') {
                 handleWritingsArticleLogic(articleDetailHash);
            }
            
            if (mainSectionTarget === 'writings-content') {
                handleWritingsArticleLogic(articleDetailHash);
            } else { 
                document.title = APP_CONFIG.DEFAULT_TITLES.home; 
            }
        }
        function handleWritingsArticleLogic(articleHash) { /* ... */ 
            const defaultWritingsTitle = APP_CONFIG.DEFAULT_TITLES.writings;
            if (articleHash && articleHash.startsWith('#post-')) {
                const targetId = articleHash.substring(1);
                const targetArticle = $(`#${targetId}`);
                if (targetArticle) {
                    const titleElement = targetArticle.querySelector('h2');
                    const articleTitle = titleElement ? titleElement.textContent.trim() : "Article";
                    document.title = `${articleTitle} - Writings - Agraj Dubey`;
                    setTimeout(() => {
                        if (!isElementInViewport(targetArticle)) targetArticle.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        const heading = targetArticle.querySelector('h2');
                        if (heading) { heading.setAttribute('tabindex', '-1'); heading.focus({ preventScroll: true }); }
                    }, 100);
                } else { document.title = defaultWritingsTitle; }
            } else {
                document.title = defaultWritingsTitle;
                const grid = $('#writings-grid-container');
                if (grid && lastClickedReadMoreLink) {
                    setTimeout(() => {
                        if (document.body.contains(lastClickedReadMoreLink)) lastClickedReadMoreLink.focus({preventScroll: true});
                        else if (grid) { grid.setAttribute('tabindex', '-1'); grid.focus({preventScroll: true}); }
                        if (grid && !isElementInViewport(grid)) grid.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }, 50);
                } lastClickedReadMoreLink = null;
            }
        }
        function isElementInViewport(el) { /* ... */ 
            if(!el) return false; const rect = el.getBoundingClientRect();
            return (rect.top >= 0 && rect.left >= 0 && rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) && rect.right <= (window.innerWidth || document.documentElement.clientWidth));
        }
        let matterEngine = null, matterRender = null; // Keep these global for secret game
        function setupSecretGame() { /* ... */ 
            const trigger = $('#secret-game-trigger'); const modal = $('#secret-game-modal'); const canvas = $('#matter-canvas'); const closeButton = $('#close-game-button');
            if (!trigger || !modal || !canvas || !closeButton || typeof Matter === 'undefined') { if(trigger) trigger.style.display = 'none'; return; }
            const Engine = Matter.Engine, Render = Matter.Render, Runner = Matter.Runner, Bodies = Matter.Bodies, Composite = Matter.Composite, Mouse = Matter.Mouse, MouseConstraint = Matter.MouseConstraint;
            trigger.addEventListener('click', () => {
                modal.style.display = 'flex';
                if (matterRender) Matter.Render.stop(matterRender); if (matterEngine) Matter.Engine.clear(matterEngine); if (canvas.firstChild) canvas.removeChild(canvas.firstChild);
                matterEngine = Engine.create({ gravity: { y: 0.6 } }); const world = matterEngine.world;
                let canvasWidth = Math.min(window.innerWidth * 0.8, 600); let canvasHeight = Math.min(window.innerHeight * 0.7, 400);
                matterRender = Render.create({ canvas: canvas, engine: matterEngine, options: { width: canvasWidth, height: canvasHeight, wireframes: false, background: 'transparent' } });
                const ground = Bodies.rectangle(canvasWidth / 2, canvasHeight - 10, canvasWidth, 20, { isStatic: true, render: { fillStyle: '#9272CE' } });
                const leftWall = Bodies.rectangle(10, canvasHeight/2, 20, canvasHeight, {isStatic: true, render: {fillStyle: '#9272CE'}});
                const rightWall = Bodies.rectangle(canvasWidth-10, canvasHeight/2, 20, canvasHeight, {isStatic: true, render: {fillStyle: '#9272CE'}});
                Composite.add(world, [ground, leftWall, rightWall]);
                for (let i = 0; i < 15; i++) { const x = Math.random() * (canvasWidth - 60) + 30; const y = Math.random() * (canvasHeight / 2); const sides = Math.floor(Math.random() * 3) + 3; const radius = Math.random() * 20 + 10; const color = ['#CBB8E8', '#AE8BD5', '#FFFFFF'][Math.floor(Math.random() * 3)]; let body; if (sides === 3 && Math.random() > 0.5) { body = Bodies.circle(x, y, radius, { render: { fillStyle: color } }); } else { body = Bodies.polygon(x, y, sides, radius, { render: { fillStyle: color } }); } Composite.add(world, body); }
                const mouse = Mouse.create(matterRender.canvas); const mouseConstraint = MouseConstraint.create(matterEngine, { mouse: mouse, constraint: { stiffness: 0.2, render: { visible: false } } });
                Composite.add(world, mouseConstraint); matterRender.mouse = mouse;
                Render.run(matterRender); const runner = Runner.create(); Runner.run(runner, matterEngine);
            });
            closeButton.addEventListener('click', () => { modal.style.display = 'none'; if (matterRender) Matter.Render.stop(matterRender); if (matterEngine) Matter.Engine.clear(matterEngine); });
        }


        document.addEventListener('DOMContentLoaded', async () => {
            resizeHyperspeedCanvas(); initStars(); animateHyperspeed(); // Hyperspeed BG
            window.addEventListener('resize', resizeHyperspeedCanvas);

            setupMobileMenu(); 
            setupScrollProgressBar();
            
            await loadAndRenderPosts(); 
            
            setupStaticImageClick();
            
            handleMainRouteChange(); 
            window.addEventListener('hashchange', handleMainRouteChange);

            const currentYearEl = $('#currentYear');
            if(currentYearEl) currentYearEl.textContent = new Date().getFullYear();
            setupSecretGame();
        });
    </script>
</body>
</html>
